# Data-Structure
### 家谱管理系统 数据结构大作业

##### 指导思想：

引入python的pandas工具，使用DataFrame、list等数据结构，进行数据的文件处理，将基本信息存储在csv文件中，利用DataFrame中对csv文件进行处理的相关函数对其进行操作，可对基本信息完成增、删、查、改操作；根据亲属关系对csv文件中存储的成员构造树结构，进行关系建立，再利用树结构进行查询、删除、一些基本信息的统计操作。

##### 设计理念：

设计一个能够界面操作的家谱管理系统，可以添加成员，删除成员，修改成员的基本信息，按照基本信息和亲戚关系查询成员，统计成员基本信息的家谱管理系统。以上功能要成功实现，界面要简洁明了，符合用户操作逻辑。另外，该系统应能够自动创建家谱文件存储在使用者的计算机内，实现家谱信息的保存。家谱内的成员能够以树形结构输出，以便直观地展示成员之间的关系。（功能及要求）

##### 方案选择：

在本家谱管理系统中，因为pandas库中DataFrame结构有一系列函数可以很方便地对csv文件进行创建和存储操作，我们选择了利用DataFrame来对家庭成员的基本信息进行存储操作；在增加成员信息时，我们利用list来辅助，由于不清楚用户想要增加的成员数目且list的长度具有灵活性，在新增成员信息时，每当新输入的一个成员信息，先新建一个类，将这个成员的信息通过类的属性放入字典中，最后再将字典追加入list中；利用树形结构来存储家族成员的关系。先编写了后端操作的程序，对家谱文件进行操作和结构建立，再编写可视化的前端程序，提供给用户管理家谱信息的操作。每张家谱是一棵树，成员的添加、删除、修改操作函数都是基于这棵树进行操作；每个成员是一个member类的对象，对象的属性就是成员的基本信息；每个文件存储一张家谱，这个家族所有已录入成员的信息就存放在里面。

##### 方案特点：

如果运行时使用者的电脑内不存在家谱文件，系统会自动在同一文件夹下创建家谱表格，输入的成员能够保持信息完整、安全地储存在计算机。整个系统需要有python环境才能运行。

![img](file:///C:\Users\92161\AppData\Local\Temp\ksohtml14156\wps1.jpg)

##### 遇到的问题以及解决办法：

1. 刚开始时我由于C++惯性思维，设计的是每一个成员建立一个类，将成员的基本信息放在类的属性里面存储，然后再将这个类的实例对象放进list里面，结果发现无法通过直接打印获取实例对象中存储的信息，无法正常打印出list里面存储的对象的正确信息，print出来的结果如图所示：

![img](file:///C:\Users\92161\AppData\Local\Temp\ksohtml14156\wps2.jpg) 

这是因为，list中存储的为类的实例对象，打印出来的自然也是这个类的实例对象。其实可以通过列表索引获取对象之后再获取这个对象的每一个属性，再打印出来，但这样不够简便。后来通过学习，改为在类中建立一个新的属性用来存储一个打包好所有基本信息的字典键值对，再将这个属性追加至list中，就可以一次性打印出想要的信息了，而且比原来设计的方法更加简便。

2. 刚开始时出于对DataFrame结构的不熟悉，我在建立DataFrame结构的时候是没有行索引的，但实际上DataFrame结构会自动添加行索引，后来通过学习，解决办法就是在存储进csv文件的时候设置参数index=False，此方法可以有效去除自动添加的行索引。

3. 还是出于对DataFrame结构的不熟悉，在读取文件存储的信息时，将文件数据转化为DataFrame结构之后，获取DataFrame结构的具体某行某列的信息时，不知采用何种办法获取，DataFrame结构有两种方法获取具体某行某列的信息，一种是iloc索引器，行列都使用隐式索引；另一种是loc索引器，可采用显式的标签值索引，在本程序中我采用了后者，因为显式索引可以采用自定义的列名进行索引，防止隐式索引发生错乱。

4. 数据类型出错问题，在查询一些数据是数字的基本信息的时候，即便输入的数据是对的而且文件里确实有存储到与这个数据相匹配的成员信息，但就是查不到。原本选择Python有一个原因就是Python没有严格的数据类型，一切皆对象，比较方便操作，但实际上，我用type()函数排查发现，在新增成员的时候，有些基本信息，比如身高，是字符串类型，但存进了文件之后再取出来，就变成了数字类型，这就导致在查询身高的时候，即便输入是正确的身高数据，也会查不出相匹配的信息，因为此时输入的身高数据是字符串类型。解决办法就是强制类型转换，在将输入的数据转为数字类型再与文件中已存储的信息进行遍历查找。

5. 在查询的时候，为了避免出现避免只查询到一条符合条件的结果就结束查询，万一还有多条符合条件的结果的情况，我定义了circle函数，此函数的作用是在列表里遍历查询，将查询到的符合条件的结果标记追加进tmp_list里面，直到文件里所有成员都被遍历过，避免遗漏相关数据。

6. 在很多页面用到了Entry控件用来作为用户与程序之间的交互，若用户在输入第一组数据并点击确定后，若Entry控件不清空，则不利于用户在此页面进行下一操作且用户体验不好，解决办法就是在点击确定之后，调用控件的delete方法来清空Entry控件中的内容。

7. 在查询页面，若想连续查询，如果上一次查询结果仍留在页面，会降低用户体验，解决办法就是定义了一个信号变量记录当前页面显示的结果次数，此变量若为0则说明页面没有上一次查询留下的结果，可以直接新增Label控件显示查询结果；若为1则说明页面尚残留上一次查询留下的结果，此时应先调用类里的deleteLabel函数，这个函数里会用到控件的pack_forget()方法，将残留的结果删除，然后再显示新查询的结果。

##### 课程设计过程的收获：

1. 其实在设计用DataFrame结构来实现程序中的信息存放以及程序与文件之间的交互之前，我本来想到用numpy数组来实现，numpy数组可以实现多维信息的存放，而且也具有一系列对文件存储进行操作的函数，但是numpy数组在长度上不具备像DataFrame那样的灵活性，无法建立空数组，若要建立numpy数组则必须事先规定好维度，但在本程序中，家谱里面存储的数据数目不是唯一的，而且也可以无限增加或者删除，而DataFrame结构类似于多维矩阵或者表格数据，长度可以根据数据多少灵活调整，对信息的存储和索引都非常方便，有很大的灵活性，更重要的是基于DataFrame的CSV文件基本操作也非常方便，有一系列函数可以直接使用来进行数据在程序和文件之间的交流，可以很好地支持文件读取以及存储，CSV文件存储的格式类似于表格形式，非常适合本程序“存储多位家庭成员的多项基本信息”的需求，简单明了，所以在本程序中使用DataFrame比numpy更好。

2. 在新增成员的部分中，考虑到在获取到用户输入的数据之后无法直接把数据放入DataFrame结构里，我设计利用list来辅助，由于不清楚用户想要增加的成员数目且list的长度具有灵活性，在新增成员信息时，每当新输入的一个成员信息，先新建一个类，将这个成员的信息通过类的属性放入字典中，最后再将字典追加入list中，最后再通过list构建DataFrame，从而方便进行下一步操作。
3. 在图形界面编写上，学习了Python的Tkinter 编程知识，一些图形界面显示的控件基础知识，在实现过程中，出于优化用户体验的考虑，增加了一些输入框清空和前一次结果的标签控件移除的细节。

##### 课程设计实现过程中的体会：

本次课程设计组队合作中，我体会颇深。从开始分工到各自写代码，再到后来将每个人的部分整合起来形成一个可用的程序，我们团队都有为这个程序付出很多，非常用心交流沟通合作。

1. 首先是对题目的分析，在开始分工之前，大家一起深入讨论了题目，谈了各自对题目的理解，对功能需求的分析，从而平均分出4个部分，虽然在分工之后各写各的代码，但总有一些东西是整个程序所有人都会用到的，所以在分析项目时，我们先确定了我们公用的结构和变量，需要用什么数据结构，哪些函数是可以让大家公用的。

2. 因为不同功能的代码总会有点联系，队友在写他们的部分时对自己的代码也要用到，在和队友交接的时候，要写交接文档，文档里面写清楚自己写的代码里面变量的名称和意义，每个函数的逻辑结构，整个功能是如何设计实现的，以及队友要调用自己写的某些函数时要注意些什么。

3. 在实现功能的时候不仅要考虑功能的完成度，还要考虑到用户体验。设计一个软件，最终是要面向大众用户的，所以软件的提示词应该简单明确，让用户一看就明白，操作逻辑也要符合大众的惯性思路，还有很多细节，比如输入框的自动清空以及前次结果的删除等。

4. 团队合作的意识加强了很多。有时候和队友对于题目功能需求的理解有分歧，或者对于功能实现有着不一样的看法，要及时商量沟通，虽然每个人都有自己的分工部分，但我们不会说做完自己的部分就直接丢给队友，其他什么都不理这样，我们也会去看对方是怎么实现自己的功能的，并且会提出简化逻辑的方法意见等，互相商量，一起进步。